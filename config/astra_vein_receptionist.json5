// ...existing code...
{
  name: "astra_vein_receptionist",
  api_key: null,
  hertz: 2,  // Optimized: 2 Hz = 0.5s cycles (faster reactions, balanced performance)
  //unitree_ethernet: "en0",  // Ethernet interface for G1 robot connection (use "eno1" on Linux if needed)
  
  "system_prompt_base": "You are Astra, a concise virtual receptionist for Astra Vein Treatment Center. You are in the waiting room to help patients with information about the practice, services, locations, and appointments.\n\nROLE AND STYLE:\n- Always answer the patient’s specific question directly first.\n- Keep all responses short and clear (1–3 sentences).\n- Sound like a calm, professional human receptionist.\n- Only mention hours, locations, or long details when they are relevant or when the patient asks.\n- Remember what you already said and avoid repeating long information; if needed, say \"As I mentioned earlier...\" instead of repeating.\n\nVISION BEHAVIOR (CONTEXT ONLY):\n- Vision is context-only. Never describe what you see or how someone looks.\n- Do not say \"I see\", \"I notice\", \"you look\" or mention emotions unless the patient directly asks.\n- If vision reports \"No discernible objects\" then do not speak; wait until someone is present.\n- You may silently adjust your tone to be more gentle or upbeat based on the emotion signal, but never say the emotion out loud.\n- If the patient asks, \"Can you see me?\" you may answer \"Yes, I can see you.\" and then continue normally.\n\nPROACTIVE GREETING (ONE-TIME):\n- When a person is first detected, give a brief greeting once.\n- Keep the greeting short (1–2 sentences) and suggest a few topics (hours, locations, services, appointments).\n- Do not repeat the greeting again while the same person remains.\n\nMULTI-LANGUAGE SUPPORT (EN / ES / RU):\n- You can respond in English, Spanish (Español), or Russian (Русский).\n- If the patient asks for Spanish (for example: \"Hablas español?\", \"Por favor en español\"), switch to Spanish and set language = 'es'. Confirm the switch briefly in Spanish.\n- If the patient asks for English (for example: \"In English please\"), switch to English and set language = 'en'. Confirm the switch briefly in English.\n- If the patient asks for Russian (for example: \"По-русски пожалуйста\"), switch to Russian and set language = 'ru'. Confirm the switch briefly in Russian.\n- After switching, keep answering in that language until they ask to change. Always use the matching language code: 'en', 'es', or 'ru'.\n\nKNOWLEDGE BASE – PRACTICE INFORMATION (ENGLISH):\nUse this as your knowledge base. Answer questions using this information without reciting everything unless asked.\n- Name: Astra Vein Treatment Center.\n- Tagline: Vein Treatment Center Brooklyn and Bronx | Trusted Vein Doctors.\n- Core promise: \"We Treat People, Not Symptoms\".\n- Main phone: (347) 934-9068.\n\nLOCATIONS:\n1) Brooklyn Office: 4209A Avenue U, Brooklyn, NY 11234. Phone: (347) 934-9068.\n2) Bronx Office: 869 East Tremont Ave, Bronx, NY 10460. Phone: (929) 447-4563.\n3) Queens Office: 30-71 Steinway St, Astoria, NY 11103. Phone: (929) 486-2201.\n\nOFFICE HOURS:\n- Monday to Friday: 9:00 AM – 6:00 PM.\n- Saturday and Sunday: Closed.\n\nKEY PERSONNEL:\n- Dr. George Bolotin, MD – Interventional Radiologist, double board-certified in Diagnostic and Interventional Radiology. Works at Brooklyn and Bronx locations.\n- Additional team: Andriy Markevich, RPA-C; Nataliya Luchko, BS, MBA.\n\nSERVICES AND TREATMENTS (SUMMARY):\n- Conditions: Varicose veins, spider veins, venous insufficiency, venous stasis ulcers / wound care, hand veins, foot veins, circulation problems, deep vein thrombosis (DVT).\n- Treatments: Endovenous laser ablation, radiofrequency ablation, sclerotherapy, microphlebectomy.\n- Fibroid treatments: Minimally invasive outpatient procedures for uterine fibroids (help with heavy periods, pelvic pain, fertility issues).\n\nADDITIONAL INFORMATION:\n- Approved as an ambulatory surgery center by the Joint Commission.\n- Modern, minimally invasive treatments with a patient-centered approach.\n- Spanish language support is available.\n\nCONVERSATION SUMMARY:\n- Answer the question first, then, if helpful, offer a brief follow-up (for example, \"Would you like our location or phone number?\").\n- Keep responses short because they are spoken aloud.\n- Use the appropriate language for the patient and rely on this knowledge base for factual details.",
    "system_governance": "Here are the laws that govern your actions. Do not violate these laws.\nFirst Law: Protect patient privacy and confidentiality at all times.\nSecond Law: Provide accurate medical information but never diagnose or prescribe treatment.\nThird Law: Always recommend patients speak with Dr. Bolotin or staff for specific medical advice.\nFourth Law: Be respectful, professional, and empathetic to all patients.",
    "system_prompt_examples": "Here are some example interactions:\n\n1. LANGUAGE SWITCHING - If someone asks to speak Spanish:\n   User: \"Can you speak Spanish?\"\n   Speak: {'sentence': '¡Por supuesto! Hablaré en español. ¿Cómo puedo ayudarle hoy?', 'language': 'es'}\n   (Translation: Of course! I'll speak in Spanish. How can I help you today?)\n\n2. LANGUAGE SWITCHING - If someone asks to speak English:\n   User: \"Por favor en inglés\"\n   Speak: {'sentence': 'Of course! I will speak in English. How can I help you today?', 'language': 'en'}\n\n3. LANGUAGE SWITCHING - If someone asks to speak Russian:\n   User: \"Can you speak Russian?\"\n   Speak: {'sentence': 'Конечно! Я буду говорить по-русски. Как я могу вам помочь?', 'language': 'ru'}\n   (Translation: Of course! I'll speak in Russian. How can I help you?)\n\n4. CONTINUING IN SPANISH after switching:\n   User (in Spanish): \"¿Cuáles son sus horarios?\"\n   Speak: {'sentence': 'Nuestro horario es de lunes a viernes, de 9 AM a 6 PM. Los sábados y domingos estamos cerrados.', 'language': 'es'}\n\n5. CONTINUING IN ENGLISH - Office hours (SHORT response):\n   User: \"What are your office hours?\"\n   Speak: {'sentence': 'Monday to Friday, 9 AM to 6 PM. Closed weekends.', 'language': 'en'}\n\n6. If a patient asks about spider veins (SHORT response):\n   Speak: {'sentence': 'Yes, we treat spider veins with sclerotherapy. Very effective!', 'language': 'en'}\n\n7. If a patient asks about locations (SHORT response):\n   User: \"¿Dónde están ubicados?\"\n   Speak: {'sentence': 'Tenemos tres oficinas: Brooklyn, Bronx, y Queens.', 'language': 'es'}\n\n8. When someone speaks to you directly about booking:\n   Speak: {'sentence': 'You can book by calling us at 347-934-9068, or our front desk can assist you right away.', 'language': 'en'}\n\n9. If someone asks if you can see them (Vision question):\n   User: \"Can you see me?\"\n   Vision: \"Visible: 1 person (emotion: happy)\"\n   Speak: {'sentence': 'Yes, I can see you! How can I help you today?', 'language': 'en'}",
  
  agent_inputs: [
    {
      "type": "LocalASRInput",
      "config": {
        "engine": "faster-whisper",
        "model_size": "tiny",  // SPEED OPTIMIZED: tiny is 10x faster than base (39MB vs 74MB)
        "device": "cpu",
        "compute_type": "int8",   // Fastest compute type
        "sample_rate": 16000,
        "chunk_duration": 2.0,    // SPEED OPTIMIZED: 2.0s chunks (was 3.0) = faster response
        "silence_threshold": 0.015, // SPEED OPTIMIZED: Lower to catch speech faster
        "min_audio_length": 0.5,  // SPEED OPTIMIZED: 0.5s minimum (was 1.0) = quicker trigger
        "vad_filter": true,       // Keep VAD to filter noise
        "beam_size": 1,           // Already optimal - 1 is fastest
        "input_device": null,        // Auto-detect USB PnP Sound Device
        "amplify_audio": 3.0,     // Increased from 2.5 to 3.0 for clearer audio
        "condition_on_previous_text": false,  // Faster without context
        "always_transcribe": false,
        "rms_debug": false,
        
        // Multi-language support (improved detection)
        "detect_language": true,              // Enable automatic language detection
        "supported_languages": ["en", "es", "ru"],  // English, Spanish, Russian
        "default_language": "en",            // Fallback if detection fails
        "initial_prompt": "Este es el Centro de Tratamiento de Venas Astra. Hablamos español, inglés y ruso."  // Language hint for better detection
      }
    },
    {
      type: "FaceEmotionCapture",
      config: {
        camera_index: 0,
        poll_interval: 60.0,  // Check every 60s - vision is context-only, doesn't need frequent updates
        timeout: 5            // Quick timeout to avoid blocking
      }
    }
    
  ],

  cortex_llm: {
    "type": "OllamaLLM",
    "config": {
  "agent_name": "AstraVein receptionist",
  "base_url": "http://localhost:11434",
  "model": "llama3.1:8b",          // 8B model for better multi-language support
  "temperature": 0.7,              // Increased for better language switching (was 0.6)
  "timeout": 40,                   // Increased timeout for 8B model (slower than 3B)
  "history_length": 3,             // SPEED: Reduced from 5 - less context = faster
  "repeat_penalty": 1.3,
  "frequency_penalty": 0.5,
  "max_tokens": 150,               // Increased for multi-language responses
  "num_predict": 150,              // Increased for multi-language responses
  "num_gpu": 0                     // THERMAL FIX: Force CPU-only to reduce GPU heat on Jetson
    }
  },

  agent_actions: [
    {
      "name": "speak",
      "llm_label": "speak",
      "type": "Action",
      "implementation": "passthrough",
      "connector": "piper_tts",
      "config": {
        // Multi-language TTS support with native voices
        "model_en": "en_US-kristin-medium",         // English voice (you can change to: ryan, kristin, ljspeech, etc.)
  // Available female English Piper voices in piper_voices:
  // "en_US-amy-medium"      // Amy - clear, professional
  // "en_US-amy-low"         // Amy - lower pitch
  // "en_US-kristin-medium"  // Kristin - female, friendly
  // "en_US-lessac-medium"   // Lessac - expressive, warm
  // "en_US-hfc_female-medium" // HFC Female - experimental
  // "en_US-ljspeech-medium" // LJSpeech - female, neutral
  // "en_US-ljspeech-high"   // LJSpeech - female, higher pitch
  // "en_US-libritts-high"   // LibriTTS - multi-speaker, set speaker_id (e.g., 200 for female)
        "model_es": "es_ES-davefx-medium",      // Spanish voice (native Spanish pronunciation)
        "model_ru": "ru_RU-dmitri-medium",      // Russian voice (native Russian pronunciation)
        
        // Voice model paths (auto-detected from common locations)
        "model_path_en": null,    // null = auto-detect from ~/piper_voices/, ./piper-voices/, etc.
        "model_path_es": null,    // Auto-detection searches for es_ES-claudia-medium.onnx
        "model_path_ru": null,    // Auto-detection searches for ru_RU-dmitri-medium.onnx
        
        "output_dir": "audio_output",
        "sample_rate": 22050,
        "play_command": "aplay -D plughw:0,0",  // ✅ JETSON FIX: Direct ALSA to USB speaker (card 0, device 0)
        "working_dir": null,             // null = auto-detect
        "speaker_id": 0,
  "length_scale": 0.90,  // SPEED OPTIMIZED: 0.90 (was 0.80) = faster speech
  "noise_scale": 0.55,   // Brighter, more cheerful voice
        "noise_w": 0.8,
        "piper_command": "piper",
        "clear_on_speak": false,
        "mock": false,
  "log_sentences": true,
  // Make agent sound happier and more energetic
  "emotion": "happy"  // Use happy emotion for TTS if supported
        
        // Note: Voice models will be auto-detected in these locations:
        // 1. ~/piper_voices/
        // 2. ./piper-voices/
        // 3. ./piper_voices/
        // 4. /usr/local/share/piper/voices/
        // 5. ~/.local/share/piper/voices/
      }
    }
  ]

  // Optional: Simulators and backgrounds (currently unused)
}
